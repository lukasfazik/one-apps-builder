
image: debian:12-slim

stages:
  - build-container
  - build-addon-context
  - build-images
  - deploy-images
  - delete-images

build-container-job:
    stage: build-container
    script:
    - echo "Preparing opennebula-tools..."
    - echo "Preparing packer..."
    - echo "Preparation complete complete."

build-addon-context-job:
  stage: build-addon-context
  script:
    - echo "Building context windows"
    - echo "Building context linux"

build-images-job:
  stage: build-images
  script:
    - echo "Building images using packer..."
    - echo "Build complete."

deploy-images-job:
  stage: deploy-images
  script:
    - echo "Deploying images to Stratus FI..."
    - echo "Images successfully deployed."

delete-images-job:
  stage: delete-images
  script:
    - echo "Removing VM template..."
    - echo "VM template removed successfully."
  when: manual
  manual_confirmation: 'Are you sure you want to delete the added template with images?'